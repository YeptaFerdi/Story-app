/*! For license information please see main.d0a0924be3bb88e072d8.js.LICENSE.txt */
(()=>{"use strict";var t,e={259:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}var o,i,a,c=(o={saveSession:function(t){t&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("name",t.name),localStorage.setItem("email",t.email))},loadSession:function(){var t=localStorage.getItem("token"),e=localStorage.getItem("name"),n=localStorage.getItem("email");return t&&e&&n?{token:t,name:e,email:n}:null},clearSession:function(){localStorage.removeItem("token"),localStorage.removeItem("name"),localStorage.removeItem("email")}},a=function(t){t&&t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("name",t.name),localStorage.setItem("email",t.email),localStorage.setItem("sessionTime",Date.now()))},(i=function(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}(i="saveSession"))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,o);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return l(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function f(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(l(e={},r,(function(){return this})),e),d=f.prototype=c.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=f,l(d,"constructor",f),l(f,"constructor",u),u.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(d),l(d,o,"Generator"),l(d,r,(function(){return this})),l(d,"toString",(function(){return"[object Generator]"})),(s=function(){return{w:i,m:y}})()}function l(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}l=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){l(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},l(t,e,n,r)}function f(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){f(i,r,o,a,c,"next",t)}function c(t){f(i,r,o,a,c,"throw",t)}a(void 0)}))}}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function y(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==u(e)?e:e+""}var v="https://story-api.dicoding.dev/v1",h=function(){return function(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}),null,[{key:"login",value:(e=p(s().m((function t(e,n){var r,o,i;return s().w((function(t){for(;;)switch(t.n){case 0:if(t.p=0,e&&n){t.n=1;break}throw new Error("Email and password are required.");case 1:return t.n=2,fetch("".concat(v,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:n})});case 2:return r=t.v,t.n=3,r.json();case 3:if(o=t.v,r.ok){t.n=4;break}throw console.error("Login failed. Status:",r.status),console.error("Server response:",o),new Error(o.message||"Login failed.");case 4:return c.saveSession({token:o.loginResult.token,name:o.loginResult.name,email:e}),t.a(2,!0);case 5:return t.p=5,i=t.v,console.error("Login Error:",i.message),t.a(2,!1)}}),t,null,[[0,5]])}))),function(t,n){return e.apply(this,arguments)})},{key:"register",value:(t=p(s().m((function t(e,n,r){var o,i,a;return s().w((function(t){for(;;)switch(t.n){case 0:if(t.p=0,e&&n&&r){t.n=1;break}throw new Error("All fields are required.");case 1:if(!(r.length<8)){t.n=2;break}throw new Error("Password must be at least 8 characters.");case 2:return t.n=3,fetch("".concat(v,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:n,password:r})});case 3:return o=t.v,t.n=4,o.json();case 4:if(i=t.v,o.ok){t.n=5;break}throw console.error("Register failed. Status:",o.status),console.error("Server response:",i),new Error(i.message||"Registration failed.");case 5:return t.a(2,!0);case 6:return t.p=6,a=t.v,console.error("Register Error:",a.message),t.a(2,!1)}}),t,null,[[0,6]])}))),function(e,n,r){return t.apply(this,arguments)})},{key:"logout",value:function(){c.clearSession()}},{key:"isLoggedIn",value:function(){return!!c.loadSession()}},{key:"getToken",value:function(){var t=c.loadSession();return t?t.token:null}},{key:"getUser",value:function(){var t=c.loadSession();return t?{name:t.name,email:t.email}:null}}]);var t,e}();function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return g(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(g(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,g(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,g(f,"constructor",s),g(s,"constructor",u),u.displayName="GeneratorFunction",g(s,o,"GeneratorFunction"),g(f),g(f,o,"Generator"),g(f,r,(function(){return this})),g(f,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:i,m:p}})()}function g(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}g=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){g(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},g(t,e,n,r)}function w(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function S(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){w(i,r,o,a,c,"next",t)}function c(t){w(i,r,o,a,c,"throw",t)}a(void 0)}))}}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O(r.key),r)}}function O(t){var e=function(t,e){if("object"!=m(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==m(e)?e:e+""}var j=function(){return function(t,e,n){return e&&k(t.prototype,e),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e}),[{key:"handleLogin",value:(e=S(b().m((function t(e,n){return b().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,h.login(e,n);case 1:t.v?this.view.navigateToHome():this.view.showError("Login failed. Incorrect email or password..");case 2:return t.a(2)}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"handleRegister",value:(t=S(b().m((function t(e,n,r){return b().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,h.register(e,n,r);case 1:t.v?(this.view.showSuccess("Registration successful. Please login."),this.view.navigateToLogin()):this.view.showError("Registration failed. Email may already be registered.");case 2:return t.a(2)}}),t,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"logout",value:function(){h.logout(),this.view.navigateToLogin()}},{key:"isAuthenticated",value:function(){return h.isLoggedIn()}},{key:"getUser",value:function(){return h.getUser()}}]);var t,e}();function E(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return T(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(T(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,T(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,T(f,"constructor",s),T(s,"constructor",u),u.displayName="GeneratorFunction",T(s,o,"GeneratorFunction"),T(f),T(f,o,"Generator"),T(f,r,(function(){return this})),T(f,"toString",(function(){return"[object Generator]"})),(E=function(){return{w:i,m:p}})()}function T(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}T=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){T(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},T(t,e,n,r)}function P(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function I(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){P(i,r,o,a,c,"next",t)}function c(t){P(i,r,o,a,c,"throw",t)}a(void 0)}))}}var _={render:function(){return I(E().m((function t(){return E().w((function(t){for(;;)if(0===t.n)return t.a(2,'\n      <section class="auth-section">\n        <h2>Login</h2>\n        <form id="login-form" aria-labelledby="login-heading">\n          '.concat('\n    <label for="email">Email address</label>\n    <input type="email" id="email" name="email" required>\n\n    <label for="password">Password</label>\n    <input type="password" id="password" name="password" required>\n  ','\n          \n          <button type="submit" aria-label="Login to Story Day account">Login</button>\n        </form>\n        <p>Don\'t have an account yet? <a href="#/register">Register</a></p>\n      </section>\n    '))}),t)})))()},afterRender:function(){var t=this;return I(E().m((function e(){return E().w((function(e){for(;;)switch(e.n){case 0:t.presenter=new j(t),document.getElementById("login-form").addEventListener("submit",(function(e){e.preventDefault();var n=document.getElementById("email").value.trim(),r=document.getElementById("password").value;r.length<8?t.showError("Password must be at least 8 characters."):t.presenter.handleLogin(n,r)}));case 1:return e.a(2)}}),e)})))()},navigateToHome:function(){window.location.hash="#/home"},showError:function(t){alert("Error: ".concat(t))}};function G(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return x(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(x(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,x(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,x(f,"constructor",s),x(s,"constructor",u),u.displayName="GeneratorFunction",x(s,o,"GeneratorFunction"),x(f),x(f,o,"Generator"),x(f,r,(function(){return this})),x(f,"toString",(function(){return"[object Generator]"})),(G=function(){return{w:i,m:p}})()}function x(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}x=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){x(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},x(t,e,n,r)}function A(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function F(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){A(i,r,o,a,c,"next",t)}function c(t){A(i,r,o,a,c,"throw",t)}a(void 0)}))}}var N={render:function(){return F(G().m((function t(){return G().w((function(t){for(;;)if(0===t.n)return t.a(2,'\n      <section class="auth-section">\n        <h2 id="register-heading">Register</h2>\n        <form id="register-form" aria-labelledby="register-heading">\n          '.concat('\n    <label for="name">Full name</label>\n    <input type="text" id="name" name="name" required minlength="2">\n\n    <label for="email">Email address</label>\n    <input type="email" id="email" name="email" required>\n\n    <label for="password">Password</label>\n    <input type="password" id="password" name="password" required minlength="8">\n  ','\n          \n          <button type="submit" aria-label="Register a new account on Story Day">Register</button>\n        </form>\n        <p>Already have an account? <a href="#/login">Login</a></p>\n      </section>\n    '))}),t)})))()},afterRender:function(){var t=this;return F(G().m((function e(){return G().w((function(e){for(;;)switch(e.n){case 0:t.presenter=new j(t),document.getElementById("register-form").addEventListener("submit",(function(e){e.preventDefault();var n=document.getElementById("name").value.trim(),r=document.getElementById("email").value.trim(),o=document.getElementById("password").value;n.length<2?t.showError("Name must be at least 2 characters."):/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(r)?o.length<8?t.showError("Password must be at least 8 characters."):t.presenter.handleRegister(n,r,o):t.showError("Invalid email format.")}));case 1:return e.a(2)}}),e)})))()},navigateToLogin:function(){window.location.hash="#/login"},showError:function(t){alert("Error: ".concat(t))},showSuccess:function(t){alert("Success: ".concat(t))}},B=n(148);function C(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return M(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(M(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,M(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,M(f,"constructor",s),M(s,"constructor",u),u.displayName="GeneratorFunction",M(s,o,"GeneratorFunction"),M(f),M(f,o,"Generator"),M(f,r,(function(){return this})),M(f,"toString",(function(){return"[object Generator]"})),(C=function(){return{w:i,m:p}})()}function M(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}M=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){M(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},M(t,e,n,r)}function U(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function R(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){U(i,r,o,a,c,"next",t)}function c(t){U(i,r,o,a,c,"throw",t)}a(void 0)}))}}var D="stories";function H(){return W.apply(this,arguments)}function W(){return(W=R(C().m((function t(){return C().w((function(t){for(;;)if(0===t.n)return t.a(2,(0,B.P2)("story-db",1,{upgrade:function(t){t.objectStoreNames.contains(D)||t.createObjectStore(D,{keyPath:"id"})}}))}),t)})))).apply(this,arguments)}var J=function(t){return R(C().m((function e(){var n,r;return C().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,H();case 1:return n=e.v,e.n=2,n.put(D,t);case 2:console.log("✅ Story saved:",t.id),e.n=4;break;case 3:e.p=3,r=e.v,console.error("❌ Failed to save story:",r);case 4:return e.a(2)}}),e,null,[[0,3]])})))()},q=function(){return R(C().m((function t(){var e,n,r;return C().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,H();case 1:return e=t.v,t.n=2,e.getAll(D);case 2:return n=t.v,t.a(2,n.filter((function(t){return t.isLocal})));case 3:return t.p=3,r=t.v,console.error("❌ Failed to get local stories:",r),t.a(2,[])}}),t,null,[[0,3]])})))()},V=function(t){return R(C().m((function e(){var n,r;return C().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,H();case 1:return n=e.v,e.n=2,n.delete(D,t);case 2:console.log("🗑️ Story with id ".concat(t," deleted")),e.n=4;break;case 3:e.p=3,r=e.v,console.error("❌ Failed to delete story ".concat(t,":"),r);case 4:return e.a(2)}}),e,null,[[0,3]])})))()},z=function(){return R(C().m((function t(){var e,n;return C().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,H();case 1:return e=t.v,t.n=2,e.clear(D);case 2:console.log("🚮 All stories cleared"),t.n=4;break;case 3:t.p=3,n=t.v,console.error("❌ Failed to clear stories:",n);case 4:return t.a(2)}}),t,null,[[0,3]])})))()};function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function Y(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return K(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(K(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,K(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,K(f,"constructor",s),K(s,"constructor",u),u.displayName="GeneratorFunction",K(s,o,"GeneratorFunction"),K(f),K(f,o,"Generator"),K(f,r,(function(){return this})),K(f,"toString",(function(){return"[object Generator]"})),(Y=function(){return{w:i,m:p}})()}function K(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}K=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){K(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},K(t,e,n,r)}function Q(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Z(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Q(i,r,o,a,c,"next",t)}function c(t){Q(i,r,o,a,c,"throw",t)}a(void 0)}))}}function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tt(r.key),r)}}function tt(t){var e=function(t,e){if("object"!=$(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$(e)?e:e+""}var et="https://story-api.dicoding.dev/v1",nt="cachedStories",rt=function(){return function(t,e,n){return e&&X(t.prototype,e),n&&X(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}),null,[{key:"getStorys",value:(e=Z(Y().m((function t(){var e,n,r,o,i,a,c,u;return Y().w((function(t){for(;;)switch(t.n){case 0:return e=h.getToken(),t.p=1,t.n=2,fetch("".concat(et,"/stories"),{headers:{Authorization:"Bearer ".concat(e)}});case 2:if((n=t.v).ok){t.n=3;break}throw new Error("Failed to fetch from API");case 3:return t.n=4,n.json();case 4:return r=t.v,o=r.listStory||[],i=o.map((function(t){return{id:t.id,description:t.description||"No Description",image:t.photoUrl&&"[uploaded]"!==t.photoUrl?t.photoUrl:null,imageBlob:null,uploader:t.name||"Anonim",createdAt:t.createdAt||"",location:{lat:t.lat||0,lng:t.lon||0},isLocal:!1}})),localStorage.setItem(nt,JSON.stringify(i)),t.a(2,i);case 5:return t.p=5,u=t.v,console.error("❌ Failed to fetch data from API:",u.message),t.n=6,q();case 6:if(!((a=t.v).length>0)){t.n=7;break}return t.a(2,a);case 7:return c=JSON.parse(localStorage.getItem(nt))||[],t.a(2,c)}}),t,null,[[1,5]])}))),function(){return e.apply(this,arguments)})},{key:"addStory",value:(t=Z(Y().m((function t(e){var n,r,o,i,a,c,u,s,l,f,p,d;return Y().w((function(t){for(;;)switch(t.n){case 0:return n=e.description,r=e.photo,o=e.lat,i=e.lon,a=h.getToken(),(c=new FormData).append("description",n),c.append("photo",r),o&&i&&(c.append("lat",o),c.append("lon",i)),t.p=1,t.n=2,fetch("".concat(et,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:c});case 2:return s=t.v,t.n=3,s.json();case 3:if(l=t.v,s.ok){t.n=4;break}throw new Error(l.message||"Failed to add data");case 4:return f={id:(null===(u=l.story)||void 0===u?void 0:u.id)||Date.now(),description:n,image:null,imageBlob:r,uploader:"You",createdAt:(new Date).toISOString(),location:{lat:o||0,lng:i||0},isLocal:!0},(p=JSON.parse(localStorage.getItem(nt))||[]).push(f),localStorage.setItem(nt,JSON.stringify(p)),t.n=5,J(f);case 5:return t.a(2,l);case 6:throw t.p=6,d=t.v,console.error("Add Story Error:",d),new Error("Failed to add story data");case 7:return t.a(2)}}),t,null,[[1,6]])}))),function(e){return t.apply(this,arguments)})}]);var t,e}();function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return at(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(at(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,at(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,at(f,"constructor",s),at(s,"constructor",u),u.displayName="GeneratorFunction",at(s,o,"GeneratorFunction"),at(f),at(f,o,"Generator"),at(f,r,(function(){return this})),at(f,"toString",(function(){return"[object Generator]"})),(it=function(){return{w:i,m:p}})()}function at(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}at=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){at(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},at(t,e,n,r)}function ct(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function ut(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ct(i,r,o,a,c,"next",t)}function c(t){ct(i,r,o,a,c,"throw",t)}a(void 0)}))}}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lt(r.key),r)}}function lt(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ot(e)?e:e+""}var ft=function(){return function(t,e,n){return e&&st(t.prototype,e),n&&st(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e}),[{key:"isAuthenticated",value:function(){return h.isLoggedIn()}},{key:"logout",value:function(){h.logout(),this.view.redirectToLogin()}},{key:"loadStorysAndMap",value:(n=ut(it().m((function t(){var e;return it().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,rt.getStorys();case 1:e=t.v,this.view.renderStorys(e),this.view.showMap(e),t.n=3;break;case 2:t.p=2,t.v,this.view.showError("Failed to load story data.");case 3:return t.a(2)}}),t,this,[[0,2]])}))),function(){return n.apply(this,arguments)})},{key:"getStorys",value:(e=ut(it().m((function t(){var e,n;return it().w((function(t){for(;;)switch(t.n){case 0:if(t.p=0,h.isLoggedIn()){t.n=1;break}return this.view.showError("Session has expired. Please re-login.."),this.view.redirectToLogin(),t.a(2,[]);case 1:return t.n=2,rt.getStorys();case 2:return(e=t.v)&&e.length>0?this.view.renderStorys(e):this.view.showError("No story data found."),t.a(2,e);case 3:return t.p=3,n=t.v,this.view.showError(n.message||"An error occurred while retrieving story data."),t.a(2,[])}}),t,this,[[0,3]])}))),function(){return e.apply(this,arguments)})},{key:"submitStory",value:(t=ut(it().m((function t(e){var n,r,o,i,a;return it().w((function(t){for(;;)switch(t.n){case 0:return n=e.description,r=e.photo,o=e.lat,i=e.lon,t.p=1,t.n=2,rt.addStory({description:n,photo:r,lat:o,lon:i});case 2:this.view.showSuccess("Story added successfully!"),t.n=4;break;case 3:t.p=3,a=t.v,this.view.showError(a.message||"Failed to add story.");case 4:return t.a(2)}}),t,this,[[1,3]])}))),function(e){return t.apply(this,arguments)})}]);var t,e,n}(),pt=function(){if(!document.getElementById("spinner")){var t=document.createElement("div");t.id="spinner",t.innerHTML='\n        <div class="spinner-overlay">\n          <div class="loader"></div>\n        </div>\n      ',document.body.appendChild(t)}},dt=function(){var t=document.getElementById("spinner");t&&t.remove()};function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function vt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(yt(t)+" is not iterable")}function ht(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function mt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ht(Object(n),!0).forEach((function(e){bt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function bt(t,e,n){return(e=Tt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return wt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function St(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return kt(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(kt(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,kt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,kt(f,"constructor",s),kt(s,"constructor",u),u.displayName="GeneratorFunction",kt(s,o,"GeneratorFunction"),kt(f),kt(f,o,"Generator"),kt(f,r,(function(){return this})),kt(f,"toString",(function(){return"[object Generator]"})),(St=function(){return{w:i,m:p}})()}function kt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}kt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){kt(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},kt(t,e,n,r)}function Ot(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function jt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ot(i,r,o,a,c,"next",t)}function c(t){Ot(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tt(r.key),r)}}function Tt(t){var e=function(t,e){if("object"!=yt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yt(e)?e:e+""}var Pt,It=function(){return function(t,e,n){return e&&Et(t.prototype,e),n&&Et(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new ft(this)}),[{key:"render",value:(n=jt(St().m((function t(){return St().w((function(t){for(;;)if(0===t.n)return t.a(2,'\n      <section class="home-section">\n        <h2 id="story-heading">Today\'s Story</h2>\n        <div id="global-map" class="story-map" style="height: 400px; margin-bottom: 2rem;" role="application" aria-label="Story location map"></div>\n        <div class="story-grid" id="story-list-container" aria-labelledby="story-heading"></div>\n      </section>\n    ')}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(e=jt(St().m((function t(){var e;return St().w((function(t){for(;;)switch(t.n){case 0:if(this.presenter.isAuthenticated()){t.n=1;break}return this.redirectToLogin(),t.a(2);case 1:return t.n=2,q();case 2:return e=t.v.map((function(t){return t.id})),localStorage.setItem("savedStoryIds",JSON.stringify(e)),pt(),t.n=3,this.presenter.loadStorysAndMap();case 3:dt(),this.updateNavbar(),this.setupThemeToggle();case 4:return t.a(2)}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"renderStorys",value:(t=jt(St().m((function t(e){var n,r,o,i,a,c=this;return St().w((function(t){for(;;)switch(t.n){case 0:if(n=document.getElementById("story-list-container")){t.n=1;break}return t.a(2);case 1:n.innerHTML="",r=gt(e),t.p=2,i=St().m((function t(){var e,r,i,a,u,s,l,f,p,d;return St().w((function(t){for(;;)switch(t.n){case 0:e=o.value,r=e.image,e.imageBlob&&(r=URL.createObjectURL(e.imageBlob)),(i=document.createElement("div")).className="story-card",i.tabIndex=0,i.setAttribute("aria-label","Story by ".concat(e.uploader," on ").concat(e.createdAt)),(a=document.createElement("img")).src=r,a.alt="Story photo",e.imageBlob&&(a.dataset.blobUrl=r),a.onload=function(){a.dataset.blobUrl&&URL.revokeObjectURL(a.dataset.blobUrl)},(u=document.createElement("p")).textContent=e.description,(s=document.createElement("p")).innerHTML="<strong>Uploader:</strong> ".concat(e.uploader),(l=document.createElement("p")).innerHTML="<strong>Created:</strong> ".concat(new Date(e.createdAt).toLocaleString()),f=document.createElement("button"),p=function(t){f.textContent=t?"🔄 Unsave":"💾 Save Offline"},d=c.isStorySaved(e.id),p(d),f.addEventListener("click",jt(St().m((function t(){var n;return St().w((function(t){for(;;)switch(t.n){case 0:if(!(n=c.isStorySaved(e.id))){t.n=2;break}return t.n=1,V(e.id);case 1:c.removeStoryId(e.id),t.n=4;break;case 2:return t.n=3,J(mt(mt({},e),{},{isLocal:!0}));case 3:c.saveStoryId(e.id);case 4:p(!n);case 5:return t.a(2)}}),t)})))),i.appendChild(a),i.appendChild(u),i.appendChild(s),i.appendChild(l),i.appendChild(f),n.appendChild(i);case 1:return t.a(2)}}),t)})),r.s();case 3:if((o=r.n()).done){t.n=5;break}return t.d(vt(i()),4);case 4:t.n=3;break;case 5:t.n=7;break;case 6:t.p=6,a=t.v,r.e(a);case 7:return t.p=7,r.f(),t.f(7);case 8:return t.a(2)}}),t,null,[[2,6,7,8]])}))),function(e){return t.apply(this,arguments)})},{key:"showMap",value:function(t){var e=document.getElementById("global-map");if(e&&0!==t.length){e._leaflet_id&&(e._leaflet_id=null);var n=t.find((function(t){var e,n;return(null===(e=t.location)||void 0===e?void 0:e.lat)&&(null===(n=t.location)||void 0===n?void 0:n.lng)}));if(n){var r=L.map("global-map").setView([n.location.lat,n.location.lng],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(r);var o=[];t.forEach((function(t){var e,n;if(null!==(e=t.location)&&void 0!==e&&e.lat&&null!==(n=t.location)&&void 0!==n&&n.lng){var i=[t.location.lat,t.location.lng];o.push(i),L.marker(i).addTo(r).bindPopup("\n            <b>".concat(t.uploader,"</b><br>\n            ").concat(t.description,"<br>\n            ").concat(new Date(t.createdAt).toLocaleString(),"\n          "))}})),o.length>0&&r.fitBounds(o)}}}},{key:"updateNavbar",value:function(){var t,e=this,n=document.getElementById("nav");n&&(n.innerHTML='\n        <a href="#/home" class="logo" aria-label="Beranda Story Day">\n          <img src="./asset/icons/logo.png" alt="Logo StoryDay" width="40" height="40">\n        </a>\n        <ul id="nav-links">\n          <li><a href="#/home">Home</a></li>\n          <li><a href="#/add">Add Story</a></li>\n          <li><a href="#/mystory">My Story</a></li>\n        </ul>\n      ',null===(t=document.getElementById("logout-btn"))||void 0===t||t.addEventListener("click",(function(t){t.preventDefault(),e.presenter.logout()})))}},{key:"setupThemeToggle",value:function(){var t=document.getElementById("theme-toggle");t&&t.addEventListener("click",(function(){document.body.classList.toggle("dark"),localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light")}))}},{key:"getSavedStoryIds",value:function(){return JSON.parse(localStorage.getItem("savedStoryIds"))||[]}},{key:"saveStoryId",value:function(t){var e=this.getSavedStoryIds();e.includes(t)||(e.push(t),localStorage.setItem("savedStoryIds",JSON.stringify(e)))}},{key:"removeStoryId",value:function(t){var e=this.getSavedStoryIds().filter((function(e){return e!==t}));localStorage.setItem("savedStoryIds",JSON.stringify(e))}},{key:"isStorySaved",value:function(t){return this.getSavedStoryIds().includes(t)}},{key:"showError",value:function(t){alert("Error: ".concat(t))}},{key:"showSuccess",value:function(t){alert("Success: ".concat(t))}},{key:"redirectToLogin",value:function(){location.hash="#/login"}}]);var t,e,n}();function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function _t(t){return function(t){if(Array.isArray(t))return Gt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Gt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return At(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(At(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,At(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,At(f,"constructor",s),At(s,"constructor",u),u.displayName="GeneratorFunction",At(s,o,"GeneratorFunction"),At(f),At(f,o,"Generator"),At(f,r,(function(){return this})),At(f,"toString",(function(){return"[object Generator]"})),(xt=function(){return{w:i,m:p}})()}function At(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}At=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){At(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},At(t,e,n,r)}function Ft(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Nt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ft(i,r,o,a,c,"next",t)}function c(t){Ft(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ct(r.key),r)}}function Ct(t){var e=function(t,e){if("object"!=Lt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Lt(e)?e:e+""}function Mt(t,e,n){Ut(t,e),e.set(t,n)}function Ut(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rt(t,e){return t.get(Ht(t,e))}function Dt(t,e,n){return t.set(Ht(t,e),n),n}function Ht(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wt=new WeakMap,Jt=new WeakMap,qt=new WeakMap,Vt=new WeakMap,zt=new WeakMap,$t=new WeakSet,Yt=function(){function t(e){var n=e.video,r=e.cameraSelect,o=e.canvas;e.options;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){Ut(t,e),e.add(t)}(this,$t),Mt(this,Wt,void 0),Mt(this,Jt,void 0),Mt(this,qt,void 0),Mt(this,Vt,void 0),Mt(this,zt,void 0),Dt(Jt,this,n),Dt(qt,this,r),Dt(Vt,this,o),Ht($t,this,Zt).call(this)}return function(t,e,n){return e&&Bt(t.prototype,e),n&&Bt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"launch",value:(e=Nt(xt().m((function e(){var n,r,o,i;return xt().w((function(e){for(;;)switch(e.n){case 0:return n=Dt,r=Wt,o=this,e.n=1,Ht($t,this,Kt).call(this);case 1:return i=e.v,n(r,o,i),t.addNewStream(Rt(Wt,this)),Rt(Jt,this).srcObject=Rt(Wt,this),e.n=2,Rt(Jt,this).play();case 2:Ht($t,this,Xt).call(this);case 3:return e.a(2)}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"addCheeseButtonListener",value:function(t,e){var n=document.querySelector(t);n&&(Dt(zt,this,n),Rt(zt,this).addEventListener("click",Nt(xt().m((function t(){return xt().w((function(t){for(;;)switch(t.n){case 0:if("function"!=typeof e){t.n=1;break}return t.n=1,e();case 1:return t.a(2)}}),t)})))))}},{key:"takePicture",value:function(){var t=Rt(Vt,this).getContext("2d"),e=Rt(Jt,this).videoWidth,n=Rt(Jt,this).videoHeight;return e&&n?(Rt(Vt,this).width=e,Rt(Vt,this).height=n,t.drawImage(Rt(Jt,this),0,0,e,n),Rt(Vt,this).toDataURL("image/jpeg")):null}}],[{key:"addNewStream",value:function(t){Array.isArray(window.currentStreams)?window.currentStreams=[].concat(_t(window.currentStreams),[t]):window.currentStreams=[t]}},{key:"stopAllStreams",value:function(){Array.isArray(window.currentStreams)?window.currentStreams.forEach((function(t){t.active&&t.getTracks().forEach((function(t){return t.stop()}))})):window.currentStreams=[]}}]);var e}();function Kt(){return Qt.apply(this,arguments)}function Qt(){return(Qt=Nt(xt().m((function t(){var e;return xt().w((function(t){for(;;)switch(t.n){case 0:if(!Rt(qt,this)){t.n=2;break}return e=Rt(qt,this).value,t.n=1,navigator.mediaDevices.getUserMedia({video:!e||{deviceId:{exact:e}},audio:!1});case 1:case 3:return t.a(2,t.v);case 2:return t.n=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}}),t,this)})))).apply(this,arguments)}function Zt(){var t=this;Rt(qt,this)&&Rt(qt,this).addEventListener("change",Nt(xt().m((function e(){return xt().w((function(e){for(;;)switch(e.n){case 0:return Pt.stopAllStreams(),e.n=1,t.launch();case 1:return e.a(2)}}),e)}))))}function Xt(){var t=Rt(Vt,this).getContext("2d");t.fillStyle="#ccc",t.fillRect(0,0,Rt(Vt,this).width,Rt(Vt,this).height)}function te(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ee(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ee(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,ee(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,ee(f,"constructor",s),ee(s,"constructor",u),u.displayName="GeneratorFunction",ee(s,o,"GeneratorFunction"),ee(f),ee(f,o,"Generator"),ee(f,r,(function(){return this})),ee(f,"toString",(function(){return"[object Generator]"})),(te=function(){return{w:i,m:p}})()}function ee(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ee=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){ee(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},ee(t,e,n,r)}function ne(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function re(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ne(i,r,o,a,c,"next",t)}function c(t){ne(i,r,o,a,c,"throw",t)}a(void 0)}))}}Pt=Yt;var oe={render:function(){return re(te().m((function t(){return te().w((function(t){for(;;)if(0===t.n)return t.a(2,'\n      <section class="add-section">\n      <h2 id="add-story-heading">Add Story</h2>\n      <form id="add-form" aria-labelledby="add-story-heading">\n          '.concat('\n    <label for="description">Story Description</label>\n    <textarea id="description" name="description" required minlength="10" placeholder="Write story description here..."></textarea>\n  ','\n          \n          <p id="photo-label"><strong>Story Photo</strong></p>\n          <button type="button" id="open-camera" aria-labelledby="photo-label">Open Camera</button>\n          <button type="button" id="take-photo" style="display:none; margin-top: 10px;" aria-label="Take photo">Take Photo</button>\n\n          <video id="camera-stream" autoplay playsinline style="display:none; width:100%; max-height:300px; border:1px solid #ccc;" aria-label="Camera preview"></video>\n          <canvas id="snapshot" style="display:none;"></canvas>\n          <input type="hidden" id="image" name="image">\n                    \n\n          <p id="map-desc">Click on the map to select a story location:</p>\n          <div id="map" style="height: 300px;" aria-describedby="map-desc" role="application"></div>\n          <input type="hidden" id="latitude" name="latitude">\n          <input type="hidden" id="longitude" name="longitude">\n\n          <button type="submit" aria-label="Add story to Story Day">Add Story</button>\n        </form>\n      </section>\n    '))}),t)})))()},afterRender:function(){var t=this;return re(te().m((function e(){var n;return te().w((function(e){for(;;)switch(e.n){case 0:if(t.presenter=new ft(t),t.presenter.isAuthenticated()){e.n=1;break}return t.redirectToLogin(),e.a(2);case 1:t.renderMap(),t.initCamera(),t.handleSubmit(),t.updateNavbar(),null===(n=document.getElementById("theme-toggle"))||void 0===n||n.addEventListener("click",(function(){document.body.classList.toggle("dark"),localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light")}));case 2:return e.a(2)}}),e)})))()},renderMap:function(){var t=this;delete L.Icon.Default.prototype._getIconUrl,L.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});var e,n=L.map("map").setView([-6.2,106.816666],10);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(n),n.on("click",(function(r){var o=r.latlng,i=o.lat,a=o.lng;document.getElementById("latitude").value=i,document.getElementById("longitude").value=a,e?e.setLatLng(r.latlng):e=L.marker(r.latlng).addTo(n),t.updatePopup(e),n.setView(r.latlng,n.getZoom())})),document.getElementById("description").addEventListener("input",(function(){t.updatePopup(e)}))},updatePopup:function(t){if(t){var e=document.getElementById("description").value||"Tanpa Deskripsi";t.bindPopup("<strong>".concat(e,"</strong>")).openPopup()}},initCamera:function(){var t=document.getElementById("open-camera"),e=document.getElementById("take-photo"),n=document.getElementById("camera-stream"),r=document.getElementById("snapshot"),o=document.getElementById("image"),i=new Yt({video:n,canvas:r});t.addEventListener("click",re(te().m((function t(){return te().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,i.launch();case 1:n.style.display="block",r.style.display="none",e.style.display="inline-block";case 2:return t.a(2)}}),t)})))),i.addCheeseButtonListener("#take-photo",re(te().m((function t(){var a;return te().w((function(t){for(;;)switch(t.n){case 0:a=i.takePicture(),o.value=a,r.style.display="block",n.style.display="none",e.style.display="none",Yt.stopAllStreams();case 1:return t.a(2)}}),t)}))))},handleSubmit:function(){var t=this;document.getElementById("add-form").addEventListener("submit",function(){var e=re(te().m((function e(n){var r,o,i,a,c,u,s;return te().w((function(e){for(;;)switch(e.n){case 0:if(n.preventDefault(),r=document.getElementById("description").value.trim(),o=document.getElementById("image").value,i=document.getElementById("latitude").value,a=document.getElementById("longitude").value,!(r.length<10)){e.n=1;break}return e.a(2,alert("Description must be at least 10 characters."));case 1:if(o){e.n=2;break}return e.a(2,alert("Please take a photo first."));case 2:if(i&&a){e.n=3;break}return e.a(2,alert("Please select a location on the map."));case 3:return e.n=4,fetch(o).then((function(t){return t.blob()}));case 4:return c=e.v,u=new File([c],"story.jpg",{type:"image/jpeg"}),s={description:r,photo:u,lat:parseFloat(i),lon:parseFloat(a)},pt(),e.n=5,t.presenter.submitStory(s);case 5:if(dt(),"granted"!==Notification.permission){e.n=7;break}return e.n=6,navigator.serviceWorker.ready;case 6:e.v.showNotification("🎉 Story added!",{body:"Your story has been submitted successfully.",icon:"./asset/icons/logo.png",badge:"./asset/favicon.png",data:{url:"#/home"}});case 7:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}())},updateNavbar:function(){var t,e=this;document.querySelector("nav").innerHTML='\n      <ul id="nav-links">\n        <li><a href="#/home">Home</a></li>\n        <li><a href="#/add">Add Story</a></li>\n        <li><a href="#/mystory">My Story</a></li>\n      </ul>\n    ',null===(t=document.getElementById("logout-btn"))||void 0===t||t.addEventListener("click",(function(t){t.preventDefault(),e.presenter.logout()}))},showSuccess:function(t){alert("Success: ".concat(t)),location.hash="#/home"},showError:function(t){alert("Error: ".concat(t))},redirectToLogin:function(){location.hash="#/login"}};function ie(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ae(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(ae(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,ae(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,ae(f,"constructor",s),ae(s,"constructor",u),u.displayName="GeneratorFunction",ae(s,o,"GeneratorFunction"),ae(f),ae(f,o,"Generator"),ae(f,r,(function(){return this})),ae(f,"toString",(function(){return"[object Generator]"})),(ie=function(){return{w:i,m:p}})()}function ae(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ae=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){ae(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},ae(t,e,n,r)}function ce(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function ue(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ce(i,r,o,a,c,"next",t)}function c(t){ce(i,r,o,a,c,"throw",t)}a(void 0)}))}}function se(t){var e=(JSON.parse(localStorage.getItem("savedStoryIds"))||[]).filter((function(e){return e!==t}));localStorage.setItem("savedStoryIds",JSON.stringify(e))}var le={render:function(){return ue(ie().m((function t(){return ie().w((function(t){for(;;)if(0===t.n)return t.a(2,'\n      <section class="my-story">\n        <h2>📦 My Saved Stories (Offline)</h2>\n        <div id="story-list" class="story-scroll-list"></div>\n        <button id="clear-all-btn" style="margin-top:1rem;">🗑 Clear All Stories</button>\n      </section>\n    ')}),t)})))()},afterRender:function(){var t=this;return ue(ie().m((function e(){var n,r,o;return ie().w((function(e){for(;;)switch(e.n){case 0:return r=document.getElementById("story-list"),e.n=1,q();case 1:if(o=e.v,r.innerHTML="",o&&0!==o.length){e.n=2;break}return r.innerHTML="<p>No stories saved offline.</p>",e.a(2);case 2:o.forEach((function(e){var n=document.createElement("article");n.className="story-card horizontal-card";var o=document.createElement("img");if(o.alt="Story photo",e.imageBlob){var i=URL.createObjectURL(e.imageBlob);o.src=i,o.onload=function(){return URL.revokeObjectURL(i)}}else e.image&&"[uploaded]"!==e.image&&(o.src=e.image);var a=document.createElement("div");a.className="story-content",a.innerHTML="\n        <p>".concat(e.description,"</p>\n        <p><strong>Uploader:</strong> ").concat(e.uploader,"</p>\n        <p><small>").concat(new Date(e.createdAt).toLocaleString(),"</small></p>\n      ");var c=document.createElement("button");c.className="delete-btn",c.textContent="🗑 Delete",c.dataset.id=e.id,c.addEventListener("click",ue(ie().m((function n(){return ie().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,V(e.id);case 1:se(e.id),t.afterRender();case 2:return n.a(2)}}),n)})))),a.appendChild(c),n.appendChild(o),n.appendChild(a),r.appendChild(n)})),null===(n=document.getElementById("clear-all-btn"))||void 0===n||n.addEventListener("click",ue(ie().m((function e(){return ie().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,z();case 1:localStorage.setItem("savedStoryIds",JSON.stringify([])),t.afterRender();case 2:return e.a(2)}}),e)}))));case 3:return e.a(2)}}),e)})))()},redirectToLogin:function(){location.hash="#/login"}};function fe(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return pe(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(pe(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,pe(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,pe(f,"constructor",s),pe(s,"constructor",u),u.displayName="GeneratorFunction",pe(s,o,"GeneratorFunction"),pe(f),pe(f,o,"Generator"),pe(f,r,(function(){return this})),pe(f,"toString",(function(){return"[object Generator]"})),(fe=function(){return{w:i,m:p}})()}function pe(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}pe=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){pe(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},pe(t,e,n,r)}function de(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function ye(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){de(i,r,o,a,c,"next",t)}function c(t){de(i,r,o,a,c,"throw",t)}a(void 0)}))}}var ve={init:function(){window.addEventListener("hashchange",this.handleRoute.bind(this)),this.handleRoute()},handleRoute:function(){var t=this;return ye(fe().m((function e(){var n,r;return fe().w((function(e){for(;;)switch(e.n){case 0:if(n=window.location.hash||"#/login",r=document.getElementById("main-content")){e.n=1;break}return console.error("main-content element not found"),e.a(2);case 1:if(!document.startViewTransition){e.n=3;break}return e.n=2,document.startViewTransition((function(){return t.renderView(n,r)}));case 2:e.n=4;break;case 3:return e.n=4,t.renderView(n,r);case 4:Yt.stopAllStreams();case 5:return e.a(2)}}),e)})))()},renderView:function(t,e){return ye(fe().m((function n(){var r,o;return fe().w((function(n){for(;;)switch(n.n){case 0:o=t,n.n="#/login"===o?1:"#/register"===o?3:"#/home"===o?5:"#/add"===o?8:"#/mystory"===o?11:14;break;case 1:return n.n=2,_.render();case 2:return e.innerHTML=n.v,_.afterRender(),n.a(3,15);case 3:return n.n=4,N.render();case 4:return e.innerHTML=n.v,N.afterRender(),n.a(3,15);case 5:if(h.isLoggedIn()){n.n=6;break}return n.a(2,location.hash="#/login");case 6:return r=new It,n.n=7,r.render();case 7:return e.innerHTML=n.v,r.afterRender(),n.a(3,15);case 8:if(h.isLoggedIn()){n.n=9;break}return n.a(2,location.hash="#/login");case 9:return n.n=10,oe.render();case 10:return e.innerHTML=n.v,oe.afterRender(),n.a(3,15);case 11:if(h.isLoggedIn()){n.n=12;break}return n.a(2,location.hash="#/login");case 12:return n.n=13,le.render();case 13:return e.innerHTML=n.v,le.afterRender(),n.a(3,15);case 14:return e.innerHTML='\n        <section style="padding: 2rem; text-align: center;">\n          <h2>404 - Page Not Found</h2>\n          <p>The page you are looking for does not exist.</p>\n          <a href="#/home" style="display:inline-block;margin-top:1rem;">🔙 Back to Home</a>\n        </section>\n      ',n.a(3,15);case 15:return n.a(2)}}),n)})))()}};function he(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return me(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(me(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,me(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,me(f,"constructor",s),me(s,"constructor",u),u.displayName="GeneratorFunction",me(s,o,"GeneratorFunction"),me(f),me(f,o,"Generator"),me(f,r,(function(){return this})),me(f,"toString",(function(){return"[object Generator]"})),(he=function(){return{w:i,m:p}})()}function me(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}me=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){me(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},me(t,e,n,r)}function be(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function ge(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){be(i,r,o,a,c,"next",t)}function c(t){be(i,r,o,a,c,"throw",t)}a(void 0)}))}}function we(t){return function(t){if(Array.isArray(t))return Se(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Se(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ke="https://story-api.dicoding.dev/v1";function Oe(t){return je.apply(this,arguments)}function je(){return(je=ge(he().m((function t(e){var n,r,o,i;return he().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,fetch("".concat(ke,"/push-subscriptions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 1:return r=t.v,t.n=2,r.json();case 2:if(o=t.v,r.ok&&null!=o&&null!==(n=o.data)&&void 0!==n&&n.success){t.n=3;break}throw new Error(o.message||"Failed to subscribe on server.");case 3:console.log("📡 Subscription sent to server:",o),t.n=5;break;case 4:t.p=4,i=t.v,console.error("❌ Error sending subscription:",i),alert("Failed to save subscription: "+i.message);case 5:return t.a(2)}}),t,null,[[0,4]])})))).apply(this,arguments)}function Ee(t){return Te.apply(this,arguments)}function Te(){return(Te=ge(he().m((function t(e){var n,r;return he().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,fetch("".concat(ke,"/push-subscriptions"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({endpoint:e})});case 1:if((n=t.v).ok){t.n=2;break}throw new Error("Server error: ".concat(n.status));case 2:console.log("📭 Unsubscription sent to server."),t.n=4;break;case 3:t.p=3,r=t.v,console.error("❌ Error unsubscribing on server:",r),alert("Failed to unsubscribe: "+r.message);case 4:return t.a(2)}}),t,null,[[0,3]])})))).apply(this,arguments)}function Pe(){return Ie.apply(this,arguments)}function Ie(){return(Ie=ge(he().m((function t(){var e,n,r;return he().w((function(t){for(;;)switch(t.n){case 0:if("serviceWorker"in navigator&&"PushManager"in window){t.n=1;break}return console.warn("🚫 Push messaging is not supported in this browser."),t.a(2);case 1:if("denied"!==Notification.permission){t.n=2;break}return alert("Notifications are blocked. Please enable them in browser settings."),t.a(2);case 2:return t.p=2,t.n=3,navigator.serviceWorker.ready;case 3:return e=t.v,t.n=4,e.pushManager.getSubscription();case 4:if(!t.v){t.n=5;break}return console.log("🔔 Already subscribed."),t.a(2);case 5:return t.n=6,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(o="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",i=void 0,a=void 0,i=(o+"=".repeat((4-o.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),a=atob(i),new Uint8Array(we(a).map((function(t){return t.charCodeAt(0)}))))});case 6:return n=t.v,console.log("🔔 New subscription:",n),alert("Successfully subscribed to push notifications!"),t.n=7,Oe(n);case 7:t.n=9;break;case 8:t.p=8,r=t.v,console.error("❌ Subscription failed:",r),alert("Subscription failed: "+r.message);case 9:return t.a(2)}var o,i,a}),t,null,[[2,8]])})))).apply(this,arguments)}function Le(){return _e.apply(this,arguments)}function _e(){return(_e=ge(he().m((function t(){var e,n,r,o;return he().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,navigator.serviceWorker.ready;case 1:return e=t.v,t.n=2,e.pushManager.getSubscription();case 2:if(n=t.v){t.n=3;break}return console.log("ℹ️ No active subscription."),t.a(2);case 3:return r=n.endpoint,t.n=4,n.unsubscribe();case 4:return t.n=5,Ee(r);case 5:console.log("🔕 Unsubscribed successfully."),alert("Unsubscribed from push notifications."),t.n=7;break;case 6:t.p=6,o=t.v,console.error("❌ Failed to unsubscribe:",o),alert("Unsubscribe failed: "+o.message);case 7:return t.a(2)}}),t,null,[[0,6]])})))).apply(this,arguments)}var Ge=n(481),xe=n.n(Ge);n(927),n(980);function Ae(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Fe(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&s&&!o&&e<l.length;e++){var o,i=l[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(Fe(e={},r,(function(){return this})),e),f=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,Fe(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=s,Fe(f,"constructor",s),Fe(s,"constructor",u),u.displayName="GeneratorFunction",Fe(s,o,"GeneratorFunction"),Fe(f),Fe(f,o,"Generator"),Fe(f,r,(function(){return this})),Fe(f,"toString",(function(){return"[object Generator]"})),(Ae=function(){return{w:i,m:p}})()}function Fe(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Fe=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var i=function(e,n){Fe(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},Fe(t,e,n,r)}function Ne(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Be(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ne(i,r,o,a,c,"next",t)}function c(t){Ne(i,r,o,a,c,"throw",t)}a(void 0)}))}}delete xe().Icon.Default.prototype._getIconUrl,xe().Icon.Default.mergeOptions({iconUrl:"leaflet/images/marker-icon.png",iconRetinaUrl:"leaflet/images/marker-icon-2x.png",shadowUrl:"leaflet/images/marker-shadow.png"}),"serviceWorker"in navigator&&window.addEventListener("load",(function(){var t="localhost"===location.hostname?"/sw.js":"/Story-app/sw.js";navigator.serviceWorker.register(t).then((function(t){console.log("✅ Service Worker registered:",t.scope),Pe()})).catch((function(t){console.error("❌ Service Worker registration failed:",t)}))})),document.addEventListener("DOMContentLoaded",(function(){var t;"dark"===localStorage.getItem("theme")&&document.body.classList.add("dark"),ve.init(),function(){var t=document.getElementById("subscribe-btn"),e=document.getElementById("unsubscribe-btn");if(t&&e){if(!("serviceWorker"in navigator)||!("PushManager"in window))return t.style.display="none",void(e.style.display="none");navigator.serviceWorker.ready.then(function(){var n=Be(Ae().m((function n(r){var o,i,a;return Ae().w((function(n){for(;;)switch(n.n){case 0:return n.p=0,n.n=1,r.pushManager.getSubscription();case 1:o=n.v,i=Boolean(o),t.style.display=i?"none":"inline-block",e.style.display=i?"inline-block":"none",n.n=3;break;case 2:n.p=2,a=n.v,console.error("Error checking subscription status",a);case 3:return n.a(2)}}),n,null,[[0,2]])})));return function(t){return n.apply(this,arguments)}}()),t.addEventListener("click",Be(Ae().m((function n(){var r;return Ae().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,Pe();case 1:return n.n=2,navigator.serviceWorker.ready;case 2:return r=n.v,n.n=3,r.pushManager.getSubscription();case 3:n.v&&(t.style.display="none",e.style.display="inline-block");case 4:return n.a(2)}}),n)})))),e.addEventListener("click",Be(Ae().m((function n(){return Ae().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,Le();case 1:t.style.display="inline-block",e.style.display="none";case 2:return n.a(2)}}),n)}))))}}(),(t=document.getElementById("skip-link"))&&t.addEventListener("click",(function(t){t.preventDefault(),setTimeout((function(){var t=document.getElementById("main-content");t&&(t.focus(),t.scrollIntoView({behavior:"smooth",block:"start"}))}),100)}))}))}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,r),i.exports}r.m=e,t=[],r.O=(e,n,o,i)=>{if(!n){var a=1/0;for(l=0;l<t.length;l++){for(var[n,o,i]=t[l],c=!0,u=0;u<n.length;u++)(!1&i||a>=i)&&Object.keys(r.O).every((t=>r.O[t](n[u])))?n.splice(u--,1):(c=!1,i<a&&(a=i));if(c){t.splice(l--,1);var s=o();void 0!==s&&(e=s)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[n,o,i]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.p="/Story-app/",(()=>{var t={792:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var o,i,[a,c,u]=n,s=0;if(a.some((e=>0!==t[e]))){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(u)var l=u(r)}for(e&&e(n);s<a.length;s++)i=a[s],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(l)},n=self.webpackChunkstory_day=self.webpackChunkstory_day||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var o=r.O(void 0,[443],(()=>r(259)));o=r.O(o)})();
//# sourceMappingURL=main.d0a0924be3bb88e072d8.js.map