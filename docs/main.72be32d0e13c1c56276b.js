/*! For license information please see main.72be32d0e13c1c56276b.js.LICENSE.txt */
(()=>{"use strict";var e,t={259:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o,i,a,c=(o={saveSession:function(e){e&&e.token&&(localStorage.setItem("token",e.token),localStorage.setItem("name",e.name),localStorage.setItem("email",e.email))},loadSession:function(){var e=localStorage.getItem("token"),t=localStorage.getItem("name"),n=localStorage.getItem("email");return e&&t&&n?{token:e,name:t,email:n}:null},clearSession:function(){localStorage.removeItem("token"),localStorage.removeItem("name"),localStorage.removeItem("email")}},a=function(e){e&&e.token&&(localStorage.setItem("token",e.token),localStorage.setItem("name",e.name),localStorage.setItem("email",e.email),localStorage.setItem("sessionTime",Date.now()))},(i=function(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}(i="saveSession"))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,o);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return l(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(l(t={},r,(function(){return this})),t),d=f.prototype=c.prototype=Object.create(p);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return u.prototype=f,l(d,"constructor",f),l(f,"constructor",u),u.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(d),l(d,o,"Generator"),l(d,r,(function(){return this})),l(d,"toString",(function(){return"[object Generator]"})),(s=function(){return{w:i,m:y}})()}function l(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){l(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},l(e,t,n,r)}function f(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,c,"next",e)}function c(e){f(i,r,o,a,c,"throw",e)}a(void 0)}))}}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function y(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}var v="https://story-api.dicoding.dev/v1",h=function(){return function(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}),null,[{key:"login",value:(t=p(s().m((function e(t,n){var r,o,i;return s().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,t&&n){e.n=1;break}throw new Error("Email and password are required.");case 1:return e.n=2,fetch("".concat(v,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})});case 2:return r=e.v,e.n=3,r.json();case 3:if(o=e.v,r.ok){e.n=4;break}throw console.error("Login failed. Status:",r.status),console.error("Server response:",o),new Error(o.message||"Login failed.");case 4:return c.saveSession({token:o.loginResult.token,name:o.loginResult.name,email:t}),e.a(2,!0);case 5:return e.p=5,i=e.v,console.error("Login Error:",i.message),e.a(2,!1)}}),e,null,[[0,5]])}))),function(e,n){return t.apply(this,arguments)})},{key:"register",value:(e=p(s().m((function e(t,n,r){var o,i,a;return s().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,t&&n&&r){e.n=1;break}throw new Error("All fields are required.");case 1:if(!(r.length<8)){e.n=2;break}throw new Error("Password must be at least 8 characters.");case 2:return e.n=3,fetch("".concat(v,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:n,password:r})});case 3:return o=e.v,e.n=4,o.json();case 4:if(i=e.v,o.ok){e.n=5;break}throw console.error("Register failed. Status:",o.status),console.error("Server response:",i),new Error(i.message||"Registration failed.");case 5:return e.a(2,!0);case 6:return e.p=6,a=e.v,console.error("Register Error:",a.message),e.a(2,!1)}}),e,null,[[0,6]])}))),function(t,n,r){return e.apply(this,arguments)})},{key:"logout",value:function(){c.clearSession()}},{key:"isLoggedIn",value:function(){return!!c.loadSession()}},{key:"getToken",value:function(){var e=c.loadSession();return e?e.token:null}},{key:"getUser",value:function(){var e=c.loadSession();return e?{name:e.name,email:e.email}:null}}]);var e,t}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return g(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(g(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,g(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,g(f,"constructor",s),g(s,"constructor",u),u.displayName="GeneratorFunction",g(s,o,"GeneratorFunction"),g(f),g(f,o,"Generator"),g(f,r,(function(){return this})),g(f,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:i,m:p}})()}function g(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}g=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){g(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},g(e,t,n,r)}function w(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){w(i,r,o,a,c,"next",e)}function c(e){w(i,r,o,a,c,"throw",e)}a(void 0)}))}}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function O(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}var j=function(){return function(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=t}),[{key:"handleLogin",value:(t=S(b().m((function e(t,n){return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,h.login(t,n);case 1:e.v?this.view.navigateToHome():this.view.showError("Login failed. Incorrect email or password..");case 2:return e.a(2)}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"handleRegister",value:(e=S(b().m((function e(t,n,r){return b().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,h.register(t,n,r);case 1:e.v?(this.view.showSuccess("Registration successful. Please login."),this.view.navigateToLogin()):this.view.showError("Registration failed. Email may already be registered.");case 2:return e.a(2)}}),e,this)}))),function(t,n,r){return e.apply(this,arguments)})},{key:"logout",value:function(){h.logout(),this.view.navigateToLogin()}},{key:"isAuthenticated",value:function(){return h.isLoggedIn()}},{key:"getUser",value:function(){return h.getUser()}}]);var e,t}();function E(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return T(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(T(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,T(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,T(f,"constructor",s),T(s,"constructor",u),u.displayName="GeneratorFunction",T(s,o,"GeneratorFunction"),T(f),T(f,o,"Generator"),T(f,r,(function(){return this})),T(f,"toString",(function(){return"[object Generator]"})),(E=function(){return{w:i,m:p}})()}function T(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}T=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){T(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},T(e,t,n,r)}function P(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,c,"next",e)}function c(e){P(i,r,o,a,c,"throw",e)}a(void 0)}))}}var _={render:function(){return I(E().m((function e(){return E().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <section class="auth-section">\n        <h2>Login</h2>\n        <form id="login-form" aria-labelledby="login-heading">\n          '.concat('\n    <label for="email">Email address</label>\n    <input type="email" id="email" name="email" required>\n\n    <label for="password">Password</label>\n    <input type="password" id="password" name="password" required>\n  ','\n          \n          <button type="submit" aria-label="Login to Story Day account">Login</button>\n        </form>\n        <p>Don\'t have an account yet? <a href="#/register">Register</a></p>\n      </section>\n    '))}),e)})))()},afterRender:function(){var e=this;return I(E().m((function t(){return E().w((function(t){for(;;)switch(t.n){case 0:e.presenter=new j(e),document.getElementById("login-form").addEventListener("submit",(function(t){t.preventDefault();var n=document.getElementById("email").value.trim(),r=document.getElementById("password").value;r.length<8?e.showError("Password must be at least 8 characters."):e.presenter.handleLogin(n,r)}));case 1:return t.a(2)}}),t)})))()},navigateToHome:function(){window.location.hash="#/home"},showError:function(e){alert("Error: ".concat(e))}};function G(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return x(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(x(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,x(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,x(f,"constructor",s),x(s,"constructor",u),u.displayName="GeneratorFunction",x(s,o,"GeneratorFunction"),x(f),x(f,o,"Generator"),x(f,r,(function(){return this})),x(f,"toString",(function(){return"[object Generator]"})),(G=function(){return{w:i,m:p}})()}function x(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}x=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){x(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},x(e,t,n,r)}function A(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){A(i,r,o,a,c,"next",e)}function c(e){A(i,r,o,a,c,"throw",e)}a(void 0)}))}}var N={render:function(){return F(G().m((function e(){return G().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <section class="auth-section">\n        <h2 id="register-heading">Register</h2>\n        <form id="register-form" aria-labelledby="register-heading">\n          '.concat('\n    <label for="name">Full name</label>\n    <input type="text" id="name" name="name" required minlength="2">\n\n    <label for="email">Email address</label>\n    <input type="email" id="email" name="email" required>\n\n    <label for="password">Password</label>\n    <input type="password" id="password" name="password" required minlength="8">\n  ','\n          \n          <button type="submit" aria-label="Register a new account on Story Day">Register</button>\n        </form>\n        <p>Already have an account? <a href="#/login">Login</a></p>\n      </section>\n    '))}),e)})))()},afterRender:function(){var e=this;return F(G().m((function t(){return G().w((function(t){for(;;)switch(t.n){case 0:e.presenter=new j(e),document.getElementById("register-form").addEventListener("submit",(function(t){t.preventDefault();var n=document.getElementById("name").value.trim(),r=document.getElementById("email").value.trim(),o=document.getElementById("password").value;n.length<2?e.showError("Name must be at least 2 characters."):/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(r)?o.length<8?e.showError("Password must be at least 8 characters."):e.presenter.handleRegister(n,r,o):e.showError("Invalid email format.")}));case 1:return t.a(2)}}),t)})))()},navigateToLogin:function(){window.location.hash="#/login"},showError:function(e){alert("Error: ".concat(e))},showSuccess:function(e){alert("Success: ".concat(e))}},B=n(148);function C(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return M(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(M(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,M(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,M(f,"constructor",s),M(s,"constructor",u),u.displayName="GeneratorFunction",M(s,o,"GeneratorFunction"),M(f),M(f,o,"Generator"),M(f,r,(function(){return this})),M(f,"toString",(function(){return"[object Generator]"})),(C=function(){return{w:i,m:p}})()}function M(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}M=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){M(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},M(e,t,n,r)}function R(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function U(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,c,"next",e)}function c(e){R(i,r,o,a,c,"throw",e)}a(void 0)}))}}var D="stories";function H(){return W.apply(this,arguments)}function W(){return(W=U(C().m((function e(){return C().w((function(e){for(;;)if(0===e.n)return e.a(2,(0,B.P2)("story-db",1,{upgrade:function(e){e.objectStoreNames.contains(D)||e.createObjectStore(D,{keyPath:"id"})}}))}),e)})))).apply(this,arguments)}var J=function(e){return U(C().m((function t(){var n,r;return C().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,H();case 1:return n=t.v,t.n=2,n.put(D,e);case 2:console.log("✅ Story saved:",e.id),t.n=4;break;case 3:t.p=3,r=t.v,console.error("❌ Failed to save story:",r);case 4:return t.a(2)}}),t,null,[[0,3]])})))()},q=function(){return U(C().m((function e(){var t,n,r;return C().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,H();case 1:return t=e.v,e.n=2,t.getAll(D);case 2:return n=e.v,e.a(2,n.filter((function(e){return e.isLocal})));case 3:return e.p=3,r=e.v,console.error("❌ Failed to get local stories:",r),e.a(2,[])}}),e,null,[[0,3]])})))()},V=function(e){return U(C().m((function t(){var n,r;return C().w((function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,H();case 1:return n=t.v,t.n=2,n.delete(D,e);case 2:console.log("🗑️ Story with id ".concat(e," deleted")),t.n=4;break;case 3:t.p=3,r=t.v,console.error("❌ Failed to delete story ".concat(e,":"),r);case 4:return t.a(2)}}),t,null,[[0,3]])})))()},z=function(){return U(C().m((function e(){var t,n;return C().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,H();case 1:return t=e.v,e.n=2,t.clear(D);case 2:console.log("🚮 All stories cleared"),e.n=4;break;case 3:e.p=3,n=e.v,console.error("❌ Failed to clear stories:",n);case 4:return e.a(2)}}),e,null,[[0,3]])})))()};function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function Y(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return K(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(K(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,K(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,K(f,"constructor",s),K(s,"constructor",u),u.displayName="GeneratorFunction",K(s,o,"GeneratorFunction"),K(f),K(f,o,"Generator"),K(f,r,(function(){return this})),K(f,"toString",(function(){return"[object Generator]"})),(Y=function(){return{w:i,m:p}})()}function K(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}K=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){K(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},K(e,t,n,r)}function Q(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Z(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Q(i,r,o,a,c,"next",e)}function c(e){Q(i,r,o,a,c,"throw",e)}a(void 0)}))}}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ee(r.key),r)}}function ee(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}var te="https://story-api.dicoding.dev/v1",ne="cachedStories",re=function(){return function(e,t,n){return t&&X(e.prototype,t),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}),null,[{key:"getStorys",value:(t=Z(Y().m((function e(){var t,n,r,o,i,a,c,u;return Y().w((function(e){for(;;)switch(e.n){case 0:return t=h.getToken(),e.p=1,e.n=2,fetch("".concat(te,"/stories"),{headers:{Authorization:"Bearer ".concat(t)}});case 2:if((n=e.v).ok){e.n=3;break}throw new Error("Failed to fetch from API");case 3:return e.n=4,n.json();case 4:return r=e.v,o=r.listStory||[],i=o.map((function(e){return{id:e.id,description:e.description||"No Description",image:e.photoUrl&&"[uploaded]"!==e.photoUrl?e.photoUrl:null,imageBlob:null,uploader:e.name||"Anonim",createdAt:e.createdAt||"",location:{lat:e.lat||0,lng:e.lon||0},isLocal:!1}})),localStorage.setItem(ne,JSON.stringify(i)),e.a(2,i);case 5:return e.p=5,u=e.v,console.error("❌ Failed to fetch data from API:",u.message),e.n=6,q();case 6:if(!((a=e.v).length>0)){e.n=7;break}return e.a(2,a);case 7:return c=JSON.parse(localStorage.getItem(ne))||[],e.a(2,c)}}),e,null,[[1,5]])}))),function(){return t.apply(this,arguments)})},{key:"addStory",value:(e=Z(Y().m((function e(t){var n,r,o,i,a,c,u,s,l,f,p,d;return Y().w((function(e){for(;;)switch(e.n){case 0:return n=t.description,r=t.photo,o=t.lat,i=t.lon,a=h.getToken(),(c=new FormData).append("description",n),c.append("photo",r),o&&i&&(c.append("lat",o),c.append("lon",i)),e.p=1,e.n=2,fetch("".concat(te,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:c});case 2:return s=e.v,e.n=3,s.json();case 3:if(l=e.v,s.ok){e.n=4;break}throw new Error(l.message||"Failed to add data");case 4:return f={id:(null===(u=l.story)||void 0===u?void 0:u.id)||Date.now(),description:n,image:null,imageBlob:r,uploader:"You",createdAt:(new Date).toISOString(),location:{lat:o||0,lng:i||0},isLocal:!0},(p=JSON.parse(localStorage.getItem(ne))||[]).push(f),localStorage.setItem(ne,JSON.stringify(p)),e.n=5,J(f);case 5:return e.a(2,l);case 6:throw e.p=6,d=e.v,console.error("Add Story Error:",d),new Error("Failed to add story data");case 7:return e.a(2)}}),e,null,[[1,6]])}))),function(t){return e.apply(this,arguments)})}]);var e,t}();function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ae(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ae(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ae(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ae(f,"constructor",s),ae(s,"constructor",u),u.displayName="GeneratorFunction",ae(s,o,"GeneratorFunction"),ae(f),ae(f,o,"Generator"),ae(f,r,(function(){return this})),ae(f,"toString",(function(){return"[object Generator]"})),(ie=function(){return{w:i,m:p}})()}function ae(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ae=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){ae(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},ae(e,t,n,r)}function ce(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ue(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ce(i,r,o,a,c,"next",e)}function c(e){ce(i,r,o,a,c,"throw",e)}a(void 0)}))}}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,le(r.key),r)}}function le(e){var t=function(e,t){if("object"!=oe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==oe(t)?t:t+""}var fe=function(){return function(e,t,n){return t&&se(e.prototype,t),n&&se(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.view=t}),[{key:"isAuthenticated",value:function(){return h.isLoggedIn()}},{key:"logout",value:function(){h.logout(),this.view.redirectToLogin()}},{key:"loadStorysAndMap",value:(n=ue(ie().m((function e(){var t;return ie().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,re.getStorys();case 1:t=e.v,this.view.renderStorys(t),this.view.showMap(t),e.n=3;break;case 2:e.p=2,e.v,this.view.showError("Failed to load story data.");case 3:return e.a(2)}}),e,this,[[0,2]])}))),function(){return n.apply(this,arguments)})},{key:"getStorys",value:(t=ue(ie().m((function e(){var t,n;return ie().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,h.isLoggedIn()){e.n=1;break}return this.view.showError("Session has expired. Please re-login.."),this.view.redirectToLogin(),e.a(2,[]);case 1:return e.n=2,re.getStorys();case 2:return(t=e.v)&&t.length>0?this.view.renderStorys(t):this.view.showError("No story data found."),e.a(2,t);case 3:return e.p=3,n=e.v,this.view.showError(n.message||"An error occurred while retrieving story data."),e.a(2,[])}}),e,this,[[0,3]])}))),function(){return t.apply(this,arguments)})},{key:"submitStory",value:(e=ue(ie().m((function e(t){var n,r,o,i,a;return ie().w((function(e){for(;;)switch(e.n){case 0:return n=t.description,r=t.photo,o=t.lat,i=t.lon,e.p=1,e.n=2,re.addStory({description:n,photo:r,lat:o,lon:i});case 2:this.view.showSuccess("Story added successfully!"),e.n=4;break;case 3:e.p=3,a=e.v,this.view.showError(a.message||"Failed to add story.");case 4:return e.a(2)}}),e,this,[[1,3]])}))),function(t){return e.apply(this,arguments)})}]);var e,t,n}(),pe=function(){if(!document.getElementById("spinner")){var e=document.createElement("div");e.id="spinner",e.innerHTML='\n        <div class="spinner-overlay">\n          <div class="loader"></div>\n        </div>\n      ',document.body.appendChild(e)}},de=function(){var e=document.getElementById("spinner");e&&e.remove()};function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function ve(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ye(e)+" is not iterable")}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e,t,n){return(t=Te(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ge(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return we(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Se(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return ke(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(ke(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ke(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,ke(f,"constructor",s),ke(s,"constructor",u),u.displayName="GeneratorFunction",ke(s,o,"GeneratorFunction"),ke(f),ke(f,o,"Generator"),ke(f,r,(function(){return this})),ke(f,"toString",(function(){return"[object Generator]"})),(Se=function(){return{w:i,m:p}})()}function ke(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ke=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){ke(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},ke(e,t,n,r)}function Oe(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function je(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Oe(i,r,o,a,c,"next",e)}function c(e){Oe(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Te(r.key),r)}}function Te(e){var t=function(e,t){if("object"!=ye(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ye(t)?t:t+""}var Pe,Ie=function(){return function(e,t,n){return t&&Ee(e.prototype,t),n&&Ee(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.presenter=new fe(this)}),[{key:"render",value:(n=je(Se().m((function e(){return Se().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <section class="home-section">\n        <h2 id="story-heading">Today\'s Story</h2>\n        <div id="global-map" class="story-map" style="height: 400px; margin-bottom: 2rem;" role="application" aria-label="Story location map"></div>\n        <div class="story-grid" id="story-list-container" aria-labelledby="story-heading"></div>\n      </section>\n    ')}),e)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(t=je(Se().m((function e(){var t;return Se().w((function(e){for(;;)switch(e.n){case 0:if(this.presenter.isAuthenticated()){e.n=1;break}return this.redirectToLogin(),e.a(2);case 1:return e.n=2,q();case 2:return t=e.v.map((function(e){return e.id})),localStorage.setItem("savedStoryIds",JSON.stringify(t)),pe(),e.n=3,this.presenter.loadStorysAndMap();case 3:de(),this.updateNavbar(),this.setupThemeToggle();case 4:return e.a(2)}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"renderStorys",value:(e=je(Se().m((function e(t){var n,r,o,i,a,c=this;return Se().w((function(e){for(;;)switch(e.n){case 0:if(n=document.getElementById("story-list-container")){e.n=1;break}return e.a(2);case 1:n.innerHTML="",r=ge(t),e.p=2,i=Se().m((function e(){var t,r,i,a,u,s,l,f,p,d;return Se().w((function(e){for(;;)switch(e.n){case 0:t=o.value,r=t.image,t.imageBlob&&(r=URL.createObjectURL(t.imageBlob)),(i=document.createElement("div")).className="story-card",i.tabIndex=0,i.setAttribute("aria-label","Story by ".concat(t.uploader," on ").concat(t.createdAt)),(a=document.createElement("img")).src=r,a.alt="Story photo",t.imageBlob&&(a.dataset.blobUrl=r),a.onload=function(){a.dataset.blobUrl&&URL.revokeObjectURL(a.dataset.blobUrl)},(u=document.createElement("p")).textContent=t.description,(s=document.createElement("p")).innerHTML="<strong>Uploader:</strong> ".concat(t.uploader),(l=document.createElement("p")).innerHTML="<strong>Created:</strong> ".concat(new Date(t.createdAt).toLocaleString()),f=document.createElement("button"),p=function(e){f.textContent=e?"🔄 Unsave":"💾 Save Offline"},d=c.isStorySaved(t.id),p(d),f.addEventListener("click",je(Se().m((function e(){var n;return Se().w((function(e){for(;;)switch(e.n){case 0:if(!(n=c.isStorySaved(t.id))){e.n=2;break}return e.n=1,V(t.id);case 1:c.removeStoryId(t.id),e.n=4;break;case 2:return e.n=3,J(me(me({},t),{},{isLocal:!0}));case 3:c.saveStoryId(t.id);case 4:p(!n);case 5:return e.a(2)}}),e)})))),i.appendChild(a),i.appendChild(u),i.appendChild(s),i.appendChild(l),i.appendChild(f),n.appendChild(i);case 1:return e.a(2)}}),e)})),r.s();case 3:if((o=r.n()).done){e.n=5;break}return e.d(ve(i()),4);case 4:e.n=3;break;case 5:e.n=7;break;case 6:e.p=6,a=e.v,r.e(a);case 7:return e.p=7,r.f(),e.f(7);case 8:return e.a(2)}}),e,null,[[2,6,7,8]])}))),function(t){return e.apply(this,arguments)})},{key:"showMap",value:function(e){var t=document.getElementById("global-map");if(t&&0!==e.length){t._leaflet_id&&(t._leaflet_id=null);var n=e.find((function(e){var t,n;return(null===(t=e.location)||void 0===t?void 0:t.lat)&&(null===(n=e.location)||void 0===n?void 0:n.lng)}));if(n){var r=L.map("global-map").setView([n.location.lat,n.location.lng],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(r);var o=[];e.forEach((function(e){var t,n;if(null!==(t=e.location)&&void 0!==t&&t.lat&&null!==(n=e.location)&&void 0!==n&&n.lng){var i=[e.location.lat,e.location.lng];o.push(i),L.marker(i).addTo(r).bindPopup("\n            <b>".concat(e.uploader,"</b><br>\n            ").concat(e.description,"<br>\n            ").concat(new Date(e.createdAt).toLocaleString(),"\n          "))}})),o.length>0&&r.fitBounds(o)}}}},{key:"updateNavbar",value:function(){var e,t=this,n=document.getElementById("nav");n&&(n.innerHTML='\n        <a href="#/home" class="logo" aria-label="Beranda Story Day">\n          <img src="./asset/icons/logo.png" alt="Logo StoryDay" width="40" height="40">\n        </a>\n        <ul id="nav-links">\n          <li><a href="#/home">Home</a></li>\n          <li><a href="#/add">Add Story</a></li>\n          <li><a href="#/mystory">My Story</a></li>\n        </ul>\n      ',null===(e=document.getElementById("logout-btn"))||void 0===e||e.addEventListener("click",(function(e){e.preventDefault(),t.presenter.logout()})))}},{key:"setupThemeToggle",value:function(){var e=document.getElementById("theme-toggle");e&&e.addEventListener("click",(function(){document.body.classList.toggle("dark"),localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light")}))}},{key:"getSavedStoryIds",value:function(){return JSON.parse(localStorage.getItem("savedStoryIds"))||[]}},{key:"saveStoryId",value:function(e){var t=this.getSavedStoryIds();t.includes(e)||(t.push(e),localStorage.setItem("savedStoryIds",JSON.stringify(t)))}},{key:"removeStoryId",value:function(e){var t=this.getSavedStoryIds().filter((function(t){return t!==e}));localStorage.setItem("savedStoryIds",JSON.stringify(t))}},{key:"isStorySaved",value:function(e){return this.getSavedStoryIds().includes(e)}},{key:"showError",value:function(e){alert("Error: ".concat(e))}},{key:"showSuccess",value:function(e){alert("Success: ".concat(e))}},{key:"redirectToLogin",value:function(){location.hash="#/login"}}]);var e,t,n}();function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function _e(e){return function(e){if(Array.isArray(e))return Ge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ge(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ge(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function xe(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Ae(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ae(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ae(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Ae(f,"constructor",s),Ae(s,"constructor",u),u.displayName="GeneratorFunction",Ae(s,o,"GeneratorFunction"),Ae(f),Ae(f,o,"Generator"),Ae(f,r,(function(){return this})),Ae(f,"toString",(function(){return"[object Generator]"})),(xe=function(){return{w:i,m:p}})()}function Ae(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ae=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Ae(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Ae(e,t,n,r)}function Fe(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ne(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Fe(i,r,o,a,c,"next",e)}function c(e){Fe(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ce(r.key),r)}}function Ce(e){var t=function(e,t){if("object"!=Le(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Le(t)?t:t+""}function Me(e,t,n){Re(e,t),t.set(e,n)}function Re(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(e,t){return e.get(He(e,t))}function De(e,t,n){return e.set(He(e,t),n),n}function He(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var We=new WeakMap,Je=new WeakMap,qe=new WeakMap,Ve=new WeakMap,ze=new WeakMap,$e=new WeakSet,Ye=function(){function e(t){var n=t.video,r=t.cameraSelect,o=t.canvas;t.options;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){Re(e,t),t.add(e)}(this,$e),Me(this,We,void 0),Me(this,Je,void 0),Me(this,qe,void 0),Me(this,Ve,void 0),Me(this,ze,void 0),De(Je,this,n),De(qe,this,r),De(Ve,this,o),He($e,this,Ze).call(this)}return function(e,t,n){return t&&Be(e.prototype,t),n&&Be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(e,[{key:"launch",value:(t=Ne(xe().m((function t(){var n,r,o,i;return xe().w((function(t){for(;;)switch(t.n){case 0:return n=De,r=We,o=this,t.n=1,He($e,this,Ke).call(this);case 1:return i=t.v,n(r,o,i),e.addNewStream(Ue(We,this)),Ue(Je,this).srcObject=Ue(We,this),t.n=2,Ue(Je,this).play();case 2:He($e,this,Xe).call(this);case 3:return t.a(2)}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"addCheeseButtonListener",value:function(e,t){var n=document.querySelector(e);n&&(De(ze,this,n),Ue(ze,this).addEventListener("click",Ne(xe().m((function e(){return xe().w((function(e){for(;;)switch(e.n){case 0:if("function"!=typeof t){e.n=1;break}return e.n=1,t();case 1:return e.a(2)}}),e)})))))}},{key:"takePicture",value:function(){var e=Ue(Ve,this).getContext("2d"),t=Ue(Je,this).videoWidth,n=Ue(Je,this).videoHeight;return t&&n?(Ue(Ve,this).width=t,Ue(Ve,this).height=n,e.drawImage(Ue(Je,this),0,0,t,n),Ue(Ve,this).toDataURL("image/jpeg")):null}}],[{key:"addNewStream",value:function(e){Array.isArray(window.currentStreams)?window.currentStreams=[].concat(_e(window.currentStreams),[e]):window.currentStreams=[e]}},{key:"stopAllStreams",value:function(){Array.isArray(window.currentStreams)?window.currentStreams.forEach((function(e){e.active&&e.getTracks().forEach((function(e){return e.stop()}))})):window.currentStreams=[]}}]);var t}();function Ke(){return Qe.apply(this,arguments)}function Qe(){return(Qe=Ne(xe().m((function e(){var t;return xe().w((function(e){for(;;)switch(e.n){case 0:if(!Ue(qe,this)){e.n=2;break}return t=Ue(qe,this).value,e.n=1,navigator.mediaDevices.getUserMedia({video:!t||{deviceId:{exact:t}},audio:!1});case 1:case 3:return e.a(2,e.v);case 2:return e.n=3,navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}}),e,this)})))).apply(this,arguments)}function Ze(){var e=this;Ue(qe,this)&&Ue(qe,this).addEventListener("change",Ne(xe().m((function t(){return xe().w((function(t){for(;;)switch(t.n){case 0:return Pe.stopAllStreams(),t.n=1,e.launch();case 1:return t.a(2)}}),t)}))))}function Xe(){var e=Ue(Ve,this).getContext("2d");e.fillStyle="#ccc",e.fillRect(0,0,Ue(Ve,this).width,Ue(Ve,this).height)}function et(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return tt(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(tt(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,tt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,tt(f,"constructor",s),tt(s,"constructor",u),u.displayName="GeneratorFunction",tt(s,o,"GeneratorFunction"),tt(f),tt(f,o,"Generator"),tt(f,r,(function(){return this})),tt(f,"toString",(function(){return"[object Generator]"})),(et=function(){return{w:i,m:p}})()}function tt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}tt=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){tt(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},tt(e,t,n,r)}function nt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function rt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){nt(i,r,o,a,c,"next",e)}function c(e){nt(i,r,o,a,c,"throw",e)}a(void 0)}))}}Pe=Ye;var ot={render:function(){return rt(et().m((function e(){return et().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <section class="add-section">\n      <h2 id="add-story-heading">Add Story</h2>\n      <form id="add-form" aria-labelledby="add-story-heading">\n          '.concat('\n    <label for="description">Story Description</label>\n    <textarea id="description" name="description" required minlength="10" placeholder="Write story description here..."></textarea>\n  ','\n          \n          <p id="photo-label"><strong>Story Photo</strong></p>\n          <button type="button" id="open-camera" aria-labelledby="photo-label">Open Camera</button>\n          <button type="button" id="take-photo" style="display:none; margin-top: 10px;" aria-label="Take photo">Take Photo</button>\n\n          <video id="camera-stream" autoplay playsinline style="display:none; width:100%; max-height:300px; border:1px solid #ccc;" aria-label="Camera preview"></video>\n          <canvas id="snapshot" style="display:none;"></canvas>\n          <input type="hidden" id="image" name="image">\n                    \n\n          <p id="map-desc">Click on the map to select a story location:</p>\n          <div id="map" style="height: 300px;" aria-describedby="map-desc" role="application"></div>\n          <input type="hidden" id="latitude" name="latitude">\n          <input type="hidden" id="longitude" name="longitude">\n\n          <button type="submit" aria-label="Add story to Story Day">Add Story</button>\n        </form>\n      </section>\n    '))}),e)})))()},afterRender:function(){var e=this;return rt(et().m((function t(){var n;return et().w((function(t){for(;;)switch(t.n){case 0:if(e.presenter=new fe(e),e.presenter.isAuthenticated()){t.n=1;break}return e.redirectToLogin(),t.a(2);case 1:e.renderMap(),e.initCamera(),e.handleSubmit(),e.updateNavbar(),null===(n=document.getElementById("theme-toggle"))||void 0===n||n.addEventListener("click",(function(){document.body.classList.toggle("dark"),localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light")}));case 2:return t.a(2)}}),t)})))()},renderMap:function(){var e=this;delete L.Icon.Default.prototype._getIconUrl,L.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});var t,n=L.map("map").setView([-6.2,106.816666],10);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(n),n.on("click",(function(r){var o=r.latlng,i=o.lat,a=o.lng;document.getElementById("latitude").value=i,document.getElementById("longitude").value=a,t?t.setLatLng(r.latlng):t=L.marker(r.latlng).addTo(n),e.updatePopup(t),n.setView(r.latlng,n.getZoom())})),document.getElementById("description").addEventListener("input",(function(){e.updatePopup(t)}))},updatePopup:function(e){if(e){var t=document.getElementById("description").value||"Tanpa Deskripsi";e.bindPopup("<strong>".concat(t,"</strong>")).openPopup()}},initCamera:function(){var e=document.getElementById("open-camera"),t=document.getElementById("take-photo"),n=document.getElementById("camera-stream"),r=document.getElementById("snapshot"),o=document.getElementById("image"),i=new Ye({video:n,canvas:r});e.addEventListener("click",rt(et().m((function e(){return et().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,i.launch();case 1:n.style.display="block",r.style.display="none",t.style.display="inline-block";case 2:return e.a(2)}}),e)})))),i.addCheeseButtonListener("#take-photo",rt(et().m((function e(){var a;return et().w((function(e){for(;;)switch(e.n){case 0:a=i.takePicture(),o.value=a,r.style.display="block",n.style.display="none",t.style.display="none",Ye.stopAllStreams();case 1:return e.a(2)}}),e)}))))},handleSubmit:function(){var e=this;document.getElementById("add-form").addEventListener("submit",function(){var t=rt(et().m((function t(n){var r,o,i,a,c,u,s;return et().w((function(t){for(;;)switch(t.n){case 0:if(n.preventDefault(),r=document.getElementById("description").value.trim(),o=document.getElementById("image").value,i=document.getElementById("latitude").value,a=document.getElementById("longitude").value,!(r.length<10)){t.n=1;break}return t.a(2,alert("Description must be at least 10 characters."));case 1:if(o){t.n=2;break}return t.a(2,alert("Please take a photo first."));case 2:if(i&&a){t.n=3;break}return t.a(2,alert("Please select a location on the map."));case 3:return t.n=4,fetch(o).then((function(e){return e.blob()}));case 4:return c=t.v,u=new File([c],"story.jpg",{type:"image/jpeg"}),s={description:r,photo:u,lat:parseFloat(i),lon:parseFloat(a)},pe(),t.n=5,e.presenter.submitStory(s);case 5:if(de(),"granted"!==Notification.permission){t.n=7;break}return t.n=6,navigator.serviceWorker.ready;case 6:t.v.showNotification("🎉 Story added!",{body:"Your story has been submitted successfully.",icon:"./asset/icons/logo.png",badge:"./asset/favicon.png",data:{url:"#/home"}});case 7:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}())},updateNavbar:function(){var e,t=this;document.querySelector("nav").innerHTML='\n      <ul id="nav-links">\n        <li><a href="#/home">Home</a></li>\n        <li><a href="#/add">Add Story</a></li>\n        <li><a href="#/mystory">My Story</a></li>\n      </ul>\n    ',null===(e=document.getElementById("logout-btn"))||void 0===e||e.addEventListener("click",(function(e){e.preventDefault(),t.presenter.logout()}))},showSuccess:function(e){alert("Success: ".concat(e)),location.hash="#/home"},showError:function(e){alert("Error: ".concat(e))},redirectToLogin:function(){location.hash="#/login"}};function it(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return at(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(at(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,at(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,at(f,"constructor",s),at(s,"constructor",u),u.displayName="GeneratorFunction",at(s,o,"GeneratorFunction"),at(f),at(f,o,"Generator"),at(f,r,(function(){return this})),at(f,"toString",(function(){return"[object Generator]"})),(it=function(){return{w:i,m:p}})()}function at(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}at=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){at(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},at(e,t,n,r)}function ct(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ut(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ct(i,r,o,a,c,"next",e)}function c(e){ct(i,r,o,a,c,"throw",e)}a(void 0)}))}}function st(e){var t=(JSON.parse(localStorage.getItem("savedStoryIds"))||[]).filter((function(t){return t!==e}));localStorage.setItem("savedStoryIds",JSON.stringify(t))}var lt={render:function(){return ut(it().m((function e(){return it().w((function(e){for(;;)if(0===e.n)return e.a(2,'\n      <section class="my-story">\n        <h2>📦 My Saved Stories (Offline)</h2>\n        <div id="story-list" class="story-scroll-list"></div>\n        <button id="clear-all-btn" style="margin-top:1rem;">🗑 Clear All Stories</button>\n      </section>\n    ')}),e)})))()},afterRender:function(){var e=this;return ut(it().m((function t(){var n,r,o;return it().w((function(t){for(;;)switch(t.n){case 0:return r=document.getElementById("story-list"),t.n=1,q();case 1:if(o=t.v,r.innerHTML="",o&&0!==o.length){t.n=2;break}return r.innerHTML="<p>No stories saved offline.</p>",t.a(2);case 2:o.forEach((function(t){var n=document.createElement("article");n.className="story-card horizontal-card";var o=document.createElement("img");if(o.alt="Story photo",t.imageBlob){var i=URL.createObjectURL(t.imageBlob);o.src=i,o.onload=function(){return URL.revokeObjectURL(i)}}else t.image&&"[uploaded]"!==t.image&&(o.src=t.image);var a=document.createElement("div");a.className="story-content",a.innerHTML="\n        <p>".concat(t.description,"</p>\n        <p><strong>Uploader:</strong> ").concat(t.uploader,"</p>\n        <p><small>").concat(new Date(t.createdAt).toLocaleString(),"</small></p>\n      ");var c=document.createElement("button");c.className="delete-btn",c.textContent="🗑 Delete",c.dataset.id=t.id,c.addEventListener("click",ut(it().m((function n(){return it().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,V(t.id);case 1:st(t.id),e.afterRender();case 2:return n.a(2)}}),n)})))),a.appendChild(c),n.appendChild(o),n.appendChild(a),r.appendChild(n)})),null===(n=document.getElementById("clear-all-btn"))||void 0===n||n.addEventListener("click",ut(it().m((function t(){return it().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,z();case 1:localStorage.setItem("savedStoryIds",JSON.stringify([])),e.afterRender();case 2:return t.a(2)}}),t)}))));case 3:return t.a(2)}}),t)})))()},redirectToLogin:function(){location.hash="#/login"}};function ft(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return pt(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(pt(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,pt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,pt(f,"constructor",s),pt(s,"constructor",u),u.displayName="GeneratorFunction",pt(s,o,"GeneratorFunction"),pt(f),pt(f,o,"Generator"),pt(f,r,(function(){return this})),pt(f,"toString",(function(){return"[object Generator]"})),(ft=function(){return{w:i,m:p}})()}function pt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}pt=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){pt(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},pt(e,t,n,r)}function dt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function yt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){dt(i,r,o,a,c,"next",e)}function c(e){dt(i,r,o,a,c,"throw",e)}a(void 0)}))}}var vt={init:function(){window.addEventListener("hashchange",this.handleRoute.bind(this)),this.handleRoute()},handleRoute:function(){var e=this;return yt(ft().m((function t(){var n,r;return ft().w((function(t){for(;;)switch(t.n){case 0:if(n=window.location.hash||"#/login",r=document.getElementById("main-content")){t.n=1;break}return console.error("main-content element not found"),t.a(2);case 1:if(!document.startViewTransition){t.n=3;break}return t.n=2,document.startViewTransition((function(){return e.renderView(n,r)}));case 2:t.n=4;break;case 3:return t.n=4,e.renderView(n,r);case 4:Ye.stopAllStreams();case 5:return t.a(2)}}),t)})))()},renderView:function(e,t){return yt(ft().m((function n(){var r,o;return ft().w((function(n){for(;;)switch(n.n){case 0:o=e,n.n="#/login"===o?1:"#/register"===o?3:"#/home"===o?5:"#/add"===o?8:"#/mystory"===o?11:14;break;case 1:return n.n=2,_.render();case 2:return t.innerHTML=n.v,_.afterRender(),n.a(3,15);case 3:return n.n=4,N.render();case 4:return t.innerHTML=n.v,N.afterRender(),n.a(3,15);case 5:if(h.isLoggedIn()){n.n=6;break}return n.a(2,location.hash="#/login");case 6:return r=new Ie,n.n=7,r.render();case 7:return t.innerHTML=n.v,r.afterRender(),n.a(3,15);case 8:if(h.isLoggedIn()){n.n=9;break}return n.a(2,location.hash="#/login");case 9:return n.n=10,ot.render();case 10:return t.innerHTML=n.v,ot.afterRender(),n.a(3,15);case 11:if(h.isLoggedIn()){n.n=12;break}return n.a(2,location.hash="#/login");case 12:return n.n=13,lt.render();case 13:return t.innerHTML=n.v,lt.afterRender(),n.a(3,15);case 14:return t.innerHTML='\n        <section style="padding: 2rem; text-align: center;">\n          <h2>404 - Page Not Found</h2>\n          <p>The page you are looking for does not exist.</p>\n          <a href="#/home" style="display:inline-block;margin-top:1rem;">🔙 Back to Home</a>\n        </section>\n      ',n.a(3,15);case 15:return n.a(2)}}),n)})))()}};function ht(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return mt(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(mt(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,mt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,mt(f,"constructor",s),mt(s,"constructor",u),u.displayName="GeneratorFunction",mt(s,o,"GeneratorFunction"),mt(f),mt(f,o,"Generator"),mt(f,r,(function(){return this})),mt(f,"toString",(function(){return"[object Generator]"})),(ht=function(){return{w:i,m:p}})()}function mt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}mt=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){mt(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},mt(e,t,n,r)}function bt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function gt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){bt(i,r,o,a,c,"next",e)}function c(e){bt(i,r,o,a,c,"throw",e)}a(void 0)}))}}function wt(e){return function(e){if(Array.isArray(e))return St(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return St(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var kt="localhost"===location.hostname&&"9000"===location.port?"/api":"https://story-api.dicoding.dev/v1";function Ot(e){return jt.apply(this,arguments)}function jt(){return(jt=gt(ht().m((function e(t){var n,r,o,i,a,c,u,s,l;return ht().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,(n=h.getToken())&&n.includes(".")){e.n=1;break}throw new Error("No valid token found. Please login first.");case 1:return r=t.toJSON(),o=r.endpoint,i=r.keys,e.n=2,fetch("".concat(kt,"/notifications/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({endpoint:o,keys:{p256dh:i.p256dh,auth:i.auth}})});case 2:if(a=e.v,null!=(c=a.headers.get("content-type"))&&c.includes("application/json")){e.n=4;break}return e.n=3,a.text();case 3:throw u=e.v,console.error("⚠️ Invalid content-type:",c),console.error("📄 Response content:\n",u),new Error("Server did not return JSON");case 4:return e.n=5,a.json();case 5:if(s=e.v,a.ok&&!s.error){e.n=6;break}throw new Error(s.message||"Failed to subscribe on server.");case 6:console.log("📡 Subscription sent to server:",s),e.n=8;break;case 7:e.p=7,l=e.v,console.error("❌ Error sending subscription:",l),alert("Failed to save subscription: "+l.message);case 8:return e.a(2)}}),e,null,[[0,7]])})))).apply(this,arguments)}function Et(e){return Tt.apply(this,arguments)}function Tt(){return(Tt=gt(ht().m((function e(t){var n,r,o,i;return ht().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,(n=h.getToken())&&n.includes(".")){e.n=1;break}throw new Error("No valid token found. Please login first.");case 1:return e.n=2,fetch("".concat(kt,"/notifications/subscribe"),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({endpoint:t})});case 2:return r=e.v,e.n=3,r.json();case 3:if(o=e.v,r.ok&&!o.error){e.n=4;break}throw new Error(o.message||"Failed to unsubscribe.");case 4:console.log("📭 Unsubscription sent to server:",o),e.n=6;break;case 5:e.p=5,i=e.v,console.error("❌ Error unsubscribing on server:",i),alert("Failed to unsubscribe: "+i.message);case 6:return e.a(2)}}),e,null,[[0,5]])})))).apply(this,arguments)}function Pt(){return It.apply(this,arguments)}function It(){return(It=gt(ht().m((function e(){var t,n,r;return ht().w((function(e){for(;;)switch(e.n){case 0:if("serviceWorker"in navigator&&"PushManager"in window){e.n=1;break}return console.warn("🚫 Push messaging is not supported in this browser."),e.a(2);case 1:if("denied"!==Notification.permission){e.n=2;break}return alert("Notifications are blocked. Please enable them in browser settings."),e.a(2);case 2:return e.p=2,e.n=3,navigator.serviceWorker.ready;case 3:return t=e.v,e.n=4,t.pushManager.getSubscription();case 4:if(!e.v){e.n=5;break}return console.log("🔔 Already subscribed."),e.a(2);case 5:return e.n=6,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(o="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",i=void 0,a=void 0,i=(o+"=".repeat((4-o.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),a=atob(i),new Uint8Array(wt(a).map((function(e){return e.charCodeAt(0)}))))});case 6:return n=e.v,console.log("🔔 New subscription:",n),alert("Successfully subscribed to push notifications!"),e.n=7,Ot(n);case 7:e.n=9;break;case 8:e.p=8,r=e.v,console.error("❌ Subscription failed:",r),alert("Subscription failed: "+r.message);case 9:return e.a(2)}var o,i,a}),e,null,[[2,8]])})))).apply(this,arguments)}function Lt(){return _t.apply(this,arguments)}function _t(){return(_t=gt(ht().m((function e(){var t,n,r,o;return ht().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,navigator.serviceWorker.ready;case 1:return t=e.v,e.n=2,t.pushManager.getSubscription();case 2:if(n=e.v){e.n=3;break}return console.log("ℹ️ No active subscription."),e.a(2);case 3:return r=n.endpoint,e.n=4,n.unsubscribe();case 4:return e.n=5,Et(r);case 5:console.log("🔕 Unsubscribed successfully."),alert("Unsubscribed from push notifications."),e.n=7;break;case 6:e.p=6,o=e.v,console.error("❌ Failed to unsubscribe:",o),alert("Unsubscribe failed: "+o.message);case 7:return e.a(2)}}),e,null,[[0,6]])})))).apply(this,arguments)}var Gt=n(481),xt=n.n(Gt);n(927),n(980);function At(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Ft(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,p.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ft(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ft(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Ft(f,"constructor",s),Ft(s,"constructor",u),u.displayName="GeneratorFunction",Ft(s,o,"GeneratorFunction"),Ft(f),Ft(f,o,"Generator"),Ft(f,r,(function(){return this})),Ft(f,"toString",(function(){return"[object Generator]"})),(At=function(){return{w:i,m:p}})()}function Ft(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ft=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var i=function(t,n){Ft(e,t,(function(e){return this._invoke(t,n,e)}))};i("next",0),i("throw",1),i("return",2)}},Ft(e,t,n,r)}function Nt(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Bt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Nt(i,r,o,a,c,"next",e)}function c(e){Nt(i,r,o,a,c,"throw",e)}a(void 0)}))}}delete xt().Icon.Default.prototype._getIconUrl,xt().Icon.Default.mergeOptions({iconUrl:"leaflet/images/marker-icon.png",iconRetinaUrl:"leaflet/images/marker-icon-2x.png",shadowUrl:"leaflet/images/marker-shadow.png"}),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js").then((function(e){console.log("✅ Service Worker registered:",e.scope),Pt()})).catch((function(e){console.error("❌ Service Worker registration failed:",e)}))})),document.addEventListener("DOMContentLoaded",(function(){var e;"dark"===localStorage.getItem("theme")&&document.body.classList.add("dark"),vt.init(),function(){var e=document.getElementById("subscribe-btn"),t=document.getElementById("unsubscribe-btn");if(e&&t){if(!("serviceWorker"in navigator)||!("PushManager"in window))return e.style.display="none",void(t.style.display="none");navigator.serviceWorker.ready.then(function(){var n=Bt(At().m((function n(r){var o,i,a;return At().w((function(n){for(;;)switch(n.n){case 0:return n.p=0,n.n=1,r.pushManager.getSubscription();case 1:o=n.v,i=Boolean(o),e.style.display=i?"none":"inline-block",t.style.display=i?"inline-block":"none",n.n=3;break;case 2:n.p=2,a=n.v,console.error("Error checking subscription status",a);case 3:return n.a(2)}}),n,null,[[0,2]])})));return function(e){return n.apply(this,arguments)}}()),e.addEventListener("click",Bt(At().m((function n(){var r;return At().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,Pt();case 1:return n.n=2,navigator.serviceWorker.ready;case 2:return r=n.v,n.n=3,r.pushManager.getSubscription();case 3:n.v&&(e.style.display="none",t.style.display="inline-block");case 4:return n.a(2)}}),n)})))),t.addEventListener("click",Bt(At().m((function n(){return At().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,Lt();case 1:e.style.display="inline-block",t.style.display="none";case 2:return n.a(2)}}),n)}))))}}(),(e=document.getElementById("skip-link"))&&e.addEventListener("click",(function(e){e.preventDefault(),setTimeout((function(){var e=document.getElementById("main-content");e&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"start"}))}),100)}))}))}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,o,i)=>{if(!n){var a=1/0;for(l=0;l<e.length;l++){for(var[n,o,i]=e[l],c=!0,u=0;u<n.length;u++)(!1&i||a>=i)&&Object.keys(r.O).every((e=>r.O[e](n[u])))?n.splice(u--,1):(c=!1,i<a&&(a=i));if(c){e.splice(l--,1);var s=o();void 0!==s&&(t=s)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,o,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.p="/",(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[a,c,u]=n,s=0;if(a.some((t=>0!==e[t]))){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(u)var l=u(r)}for(t&&t(n);s<a.length;s++)i=a[s],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(l)},n=self.webpackChunkstory_day=self.webpackChunkstory_day||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[443],(()=>r(259)));o=r.O(o)})();
//# sourceMappingURL=main.72be32d0e13c1c56276b.js.map